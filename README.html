<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title></title></head><body><h1>PostDashboard</h1>

<p><video src="AppVideo.webm" alt="AppVideo" width="300" controls loop /></p>

<p>A simple project used to illustrate clean architecture and testing in Android with Kotlin.</p>

<p>The app shows a list of posts from <a href="http://jsonplaceholder.typicode.com">JsonPlaceholder</a>. Upon tapping on one of the posts, a detail view is shown with further details on the tapped post.</p>

<h2>Architecture</h2>

<div style="text-align:center">
<img src="Architecture.png" alt="Architecture Diagram" width="400" />
</div>

<p>The hastily drawn diagram above illustrates how the Architecture for the App works. Essentially this is a slimmed down version of <a href="https://www.youtube.com/watch?v=64rQ9GKphTg">MVI</a>.</p>

<p>There are three layers to the app, namely the UI, View Model, and Repository layers. Users send an <code>Intent</code> through the View Model layer which are later emitted by a <code>State</code>. The <code>State</code> is emitted via a <code>LiveData</code>, and is all the UI layer needs to do is observe it in order to figure out what to display.</p>

<p>The View Model layer is (importantly) unidirectional, and takes intents, maps them to actions, performs the actions, and returns results. Those results are finally mapped to the <code>State</code>.</p>

<p>These mappings occur in an <code>Interpreter</code> which exists in each step along the way. For example, the <code>ActionInterpreter</code> which takes an <code>Action</code> and produces a <code>Result</code>. Below is a method in the <code>ViewModel</code> which exemplifies this process:</p>

<pre><code class="kotlin">fun sendIntent(intent: Intent) {
    launch(contextPool.IO) {
        intentInterpreter.interpret(intent) { action -&gt;
            actionInterpreter.interpret(action) { result -&gt;
                resultInterpreter.interpret(result, ::changeState)
            }
        }
    }
}
</code></pre>

<p>The Repository layer contains a <code>Repository</code> which is the logic of how the app gets data. Data is initially loaded from the network, but subsequently saved to a Database until that data is no longer viable. At the present there is no invalidation logic.</p>

<p>The UI layer is an Activity with multiple fragments - but in this app it is pretty bare bones. I decided to concentrate heavily on the Architecture as I was left pretty inspired by Droidcon London 2018 - where many of the talks involved Architecture and structuring the app in a clean way. I figured this would be a good way to put theory into practice.</p>

<h2>Installing and Testing</h2>

<p>The app can be run and installed easily from Android Studio. The instructions below are for running it via the command line.</p>

<h3>Running the app via the command line</h3>

<p>Run the following command in the repository&#39;s directory:</p>

<pre><code>./gradlew installDebug
</code></pre>

<p>If a device is connected, the app should run without a problem.</p>

<h3>Running the Espresso tests via the command line</h3>

<p>Similarly, run the following command:</p>

<pre><code>./gradlew connectedAndroidTest
</code></pre>

<h3>Running the unit tests via the command line</h3>

<p>Unit tests work the same way:</p>

<pre><code>./gradlew test
</code></pre>

<h2>Built With</h2>

<ul>
<li><a href="https://kotlinlang.org/">Kotlin</a></li>
<li><a href="https://developer.android.com/topic/libraries/architecture/lifecycle">Lifecycle</a></li>
<li><a href="https://developer.android.com/topic/libraries/architecture/livedata">LiveData</a></li>
<li><a href="https://developer.android.com/topic/libraries/architecture/viewmodel">ViewModel</a></li>
<li><a href="https://site.mockito.org/">Mockito</a></li>
<li><a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView">RecyclerView</a></li>
<li><a href="https://square.github.io/retrofit/">Retrofit</a></li>
<li><a href="https://developer.android.com/topic/libraries/architecture/room">Room</a></li>
<li><a href="https://developer.android.com/reference/android/support/constraint/ConstraintLayout">ConstraintLayout</a></li>
<li><a href="https://github.com/InsertKoinIO/koin">Koin</a></li>
<li><a href="https://github.com/nhaarman/mockito-kotlin/wiki">Mockito-Kotlin</a></li>
<li><a href="https://developer.android.com/training/testing/espresso/">Espresso</a></li>
<li><a href="https://developer.android.com/topic/libraries/architecture/navigation/">Navigation Architecture Component</a></li>
<li><a href="https://kotlinlang.org/docs/reference/coroutines-overview.html">Coroutines</a></li>
</ul>

<h2>License</h2>

<p><img src="app/src/main/res/mipmap-xxxhdpi/ic_launcher_round.png" alt=""></p>

<p>Copyright &copy; 2018 Boris Kachscovsky</p>

<p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>

<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>
</body></html>